<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.525">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Advanced Statistics - Significant Results</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="styles.css">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Advanced Statistics</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="./review.html"> 
<span class="menu-text">Basic Review</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./confidence_intervals.html"> 
<span class="menu-text">Confidence Intervals</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./statistical_hypotheses.html"> 
<span class="menu-text">Statistical Hypotheses</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./linear_regression.html"> 
<span class="menu-text">Linear Regression</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./diagnostics.html"> 
<span class="menu-text">Diagnostics</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./anova_categorical.html"> 
<span class="menu-text">ANOVA for Categorical</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./model_selection.html"> 
<span class="menu-text">Model Selection</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./bayes_nets.html"> 
<span class="menu-text">Bayesian Networks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./glm.html"> 
<span class="menu-text">Generalized Linear Models</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./gam.html"> 
<span class="menu-text">Generalized Additive Models</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./significant_results.html" aria-current="page"> 
<span class="menu-text">Significant Results</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-github">
<li>
    <a class="dropdown-item" href="https://github.com/clickityKlein/Statistics">
 <span class="dropdown-text">Source Code</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/clickityKlein">
 <span class="dropdown-text">Carl Klein’s Main Page</span></a>
  </li>  
    </ul>
</li>
</ul>
</div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link active" data-scroll-target="#hypothesis-testing">Hypothesis Testing</a>
  <ul class="collapse">
<li><a href="#t-test" id="toc-t-test" class="nav-link" data-scroll-target="#t-test">t-test</a></li>
  <li><a href="#partial-f-test" id="toc-partial-f-test" class="nav-link" data-scroll-target="#partial-f-test">Partial F-test</a></li>
  <li><a href="#full-f-test" id="toc-full-f-test" class="nav-link" data-scroll-target="#full-f-test">Full F-test</a></li>
  <li><a href="#shapiro-wilks-test" id="toc-shapiro-wilks-test" class="nav-link" data-scroll-target="#shapiro-wilks-test">Shapiro-Wilks Test</a></li>
  <li><a href="#durbin-watson-test" id="toc-durbin-watson-test" class="nav-link" data-scroll-target="#durbin-watson-test">Durbin-Watson Test</a></li>
  <li><a href="#levenes-test" id="toc-levenes-test" class="nav-link" data-scroll-target="#levenes-test">Levenes’ Test</a></li>
  <li><a href="#one-way-anova" id="toc-one-way-anova" class="nav-link" data-scroll-target="#one-way-anova">One-Way ANOVA</a></li>
  </ul>
</li>
  <li>
<a href="#important-formulas" id="toc-important-formulas" class="nav-link" data-scroll-target="#important-formulas">Important Formulas</a>
  <ul class="collapse">
<li><a href="#sse-sum-squared-error-or-rss-residual-sum-of-of-squares" id="toc-sse-sum-squared-error-or-rss-residual-sum-of-of-squares" class="nav-link" data-scroll-target="#sse-sum-squared-error-or-rss-residual-sum-of-of-squares">SSE (Sum Squared Error) or RSS (Residual Sum of of Squares)</a></li>
  <li><a href="#sst-sum-of-squares-total-or-tss-total-sum-of-squares" id="toc-sst-sum-of-squares-total-or-tss-total-sum-of-squares" class="nav-link" data-scroll-target="#sst-sum-of-squares-total-or-tss-total-sum-of-squares">SST (Sum of Squares Total) or TSS (Total Sum of Squares)</a></li>
  <li><a href="#ssr-sum-of-squared-residuals-or-rss-residual-sum-of-sqaures" id="toc-ssr-sum-of-squared-residuals-or-rss-residual-sum-of-sqaures" class="nav-link" data-scroll-target="#ssr-sum-of-squared-residuals-or-rss-residual-sum-of-sqaures">SSR (Sum of Squared Residuals) or RSS (Residual Sum of Sqaures)</a></li>
  <li><a href="#r2" id="toc-r2" class="nav-link" data-scroll-target="#r2"><span class="math inline">\(R^2\)</span></a></li>
  <li><a href="#r2_a-adjusted-r2" id="toc-r2_a-adjusted-r2" class="nav-link" data-scroll-target="#r2_a-adjusted-r2"><span class="math inline">\(R^2_a\)</span> (Adjusted <span class="math inline">\(R^2\)</span>)</a></li>
  <li><a href="#mspe-mean-squared-prediction-error" id="toc-mspe-mean-squared-prediction-error" class="nav-link" data-scroll-target="#mspe-mean-squared-prediction-error">MSPE (Mean Squared Prediction Error)</a></li>
  <li><a href="#aic-akaike-information-criteria" id="toc-aic-akaike-information-criteria" class="nav-link" data-scroll-target="#aic-akaike-information-criteria">AIC (Akaike Information Criteria)</a></li>
  <li><a href="#bic-bayesian-information-criteria" id="toc-bic-bayesian-information-criteria" class="nav-link" data-scroll-target="#bic-bayesian-information-criteria">BIC (Bayesian Information Criteria)</a></li>
  <li>
<a href="#one-way-anova-equations" id="toc-one-way-anova-equations" class="nav-link" data-scroll-target="#one-way-anova-equations">One-Way ANOVA Equations</a>
  <ul class="collapse">
<li><a href="#sst" id="toc-sst" class="nav-link" data-scroll-target="#sst">SST</a></li>
  <li><a href="#ssw-within-group-sum-of-squares" id="toc-ssw-within-group-sum-of-squares" class="nav-link" data-scroll-target="#ssw-within-group-sum-of-squares">SSW (Within-Group Sum of Squares)</a></li>
  <li><a href="#ssb-between-group-sum-of-squares" id="toc-ssb-between-group-sum-of-squares" class="nav-link" data-scroll-target="#ssb-between-group-sum-of-squares">SSB (Between-Group Sum of Squares)</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#selected-questions" id="toc-selected-questions" class="nav-link" data-scroll-target="#selected-questions">Selected Questions</a>
  <ul class="collapse">
<li><a href="#question-1" id="toc-question-1" class="nav-link" data-scroll-target="#question-1">Question 1</a></li>
  <li><a href="#answer-1" id="toc-answer-1" class="nav-link" data-scroll-target="#answer-1">Answer 1</a></li>
  <li><a href="#question-2" id="toc-question-2" class="nav-link" data-scroll-target="#question-2">Question 2</a></li>
  <li><a href="#answer-2" id="toc-answer-2" class="nav-link" data-scroll-target="#answer-2">Answer 2</a></li>
  <li><a href="#question-3" id="toc-question-3" class="nav-link" data-scroll-target="#question-3">Question 3</a></li>
  <li><a href="#answer-3" id="toc-answer-3" class="nav-link" data-scroll-target="#answer-3">Answer 3</a></li>
  <li><a href="#question-4" id="toc-question-4" class="nav-link" data-scroll-target="#question-4">Question 4</a></li>
  <li><a href="#answer-4" id="toc-answer-4" class="nav-link" data-scroll-target="#answer-4">Answer 4</a></li>
  <li><a href="#question-5" id="toc-question-5" class="nav-link" data-scroll-target="#question-5">Question 5</a></li>
  <li><a href="#answer-5" id="toc-answer-5" class="nav-link" data-scroll-target="#answer-5">Answer 5</a></li>
  <li><a href="#question-6" id="toc-question-6" class="nav-link" data-scroll-target="#question-6">Question 6</a></li>
  <li><a href="#answer-6" id="toc-answer-6" class="nav-link" data-scroll-target="#answer-6">Answer 6</a></li>
  <li><a href="#question-7" id="toc-question-7" class="nav-link" data-scroll-target="#question-7">Question 7</a></li>
  <li><a href="#answer-7" id="toc-answer-7" class="nav-link" data-scroll-target="#answer-7">Answer 7</a></li>
  <li><a href="#question-8" id="toc-question-8" class="nav-link" data-scroll-target="#question-8">Question 8</a></li>
  <li><a href="#answer-8" id="toc-answer-8" class="nav-link" data-scroll-target="#answer-8">Answer 8</a></li>
  <li><a href="#question-9" id="toc-question-9" class="nav-link" data-scroll-target="#question-9">Question 9</a></li>
  <li><a href="#answer-9" id="toc-answer-9" class="nav-link" data-scroll-target="#answer-9">Answer 9</a></li>
  <li><a href="#question-10" id="toc-question-10" class="nav-link" data-scroll-target="#question-10">Question 10</a></li>
  <li><a href="#answer-10" id="toc-answer-10" class="nav-link" data-scroll-target="#answer-10">Answer 10</a></li>
  <li><a href="#question-11" id="toc-question-11" class="nav-link" data-scroll-target="#question-11">Question 11</a></li>
  <li><a href="#answer-11" id="toc-answer-11" class="nav-link" data-scroll-target="#answer-11">Answer 11</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Significant Results</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="hypothesis-testing" class="level1"><h1>Hypothesis Testing</h1>
<section id="t-test" class="level2"><h2 class="anchored" data-anchor-id="t-test">t-test</h2>
<ul>
<li>statistic: <span class="math inline">\(t_{stat} = \frac{\hat{\beta_j} - c}{SE(\hat{\beta_j})}\)</span>
<ul>
<li><span class="math inline">\(SE(\hat{\beta_j}) = \frac{\hat{\sigma}}{\sqrt{\sum\limits_{i=1}^n (x_i - \bar{x})^2}}\)</span></li>
<li><span class="math inline">\(\hat{\sigma} = \sqrt{\frac{SSE}{n-2}}\)</span></li>
</ul>
</li>
<li>
<span class="math inline">\(H_0\)</span>: <span class="math inline">\(\beta_j = c\)</span>
</li>
<li>
<span class="math inline">\(H_A\)</span>: <span class="math inline">\(\beta_j \neq c\)</span>
</li>
</ul>
<p><span class="math inline">\(c \in \mathbb{R}\)</span></p>
<p>We’ll assume <span class="math inline">\(c=0\)</span> for most of our purposes, as this is the value that is reported for MLR models created through <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> with an <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>.</p>
<p>Used in finding if a feature has an effect on the response. In the case of a small enough p-value, we can reject the null hypothesis in favor of the alternative hypothesis which means there is statistical evidence that the associated feature (variable) has an effect on the response variable.</p>
</section><section id="partial-f-test" class="level2"><h2 class="anchored" data-anchor-id="partial-f-test">Partial F-test</h2>
<p>Given a full model (<span class="math inline">\(\Omega\)</span>) and a reduced model (<span class="math inline">\(\omega\)</span>),</p>
<ul>
<li>statistic: <span class="math inline">\(F_{stat} = \frac{\frac{SSE_{full} - SSE_{reduced}}{p-k}}{\frac{SSE_{full}}{n-p-1}}\)</span>
<ul>
<li>
<span class="math inline">\(p\)</span>: number of features in the full model</li>
<li>
<span class="math inline">\(k\)</span>: number of features in the reduced model</li>
<li>
<span class="math inline">\(n\)</span>: the total observations in the dataset</li>
</ul>
</li>
<li>
<span class="math inline">\(H_0\)</span>: <span class="math inline">\(\beta_j = 0\)</span>, <span class="math inline">\(\forall j \notin \omega\)</span> but in <span class="math inline">\(\Omega\)</span> (the reduced model is sufficient)</li>
<li>
<span class="math inline">\(H_A\)</span>: <span class="math inline">\(\beta_j \neq 0\)</span> for at least one of <span class="math inline">\(j \notin \omega\)</span> but in <span class="math inline">\(\Omega\)</span> (the reduced model is not sufficient)</li>
</ul>
<p>When there is a small enough p-value, this suggests that the reduced is not sufficient. Used in testing reduced models against full models. This is usually found through <code>anova(reduced_model, full_model)</code> for linear models, and <code>anova(reduced_model, full_model, test = "Chisq")</code> for generalized linear models (which actually turns it into the <strong>chi-squared</strong> test, as this compares the reduction in deviance between two nested models, i.e.&nbsp;it is analogous to the F-test for linear regression).</p>
</section><section id="full-f-test" class="level2"><h2 class="anchored" data-anchor-id="full-f-test">Full F-test</h2>
<ul>
<li>statistic: <span class="math inline">\(F_{stat} = \frac{\frac{SST - SSE}{p}}{\frac{SSE}{n-p-1}}\)</span>
<ul>
<li><span class="math inline">\(p = SST_{df} - SSE_{df}\)</span></li>
<li>
<span class="math inline">\(n\)</span>: number of observations in the dataset</li>
</ul>
</li>
<li>
<span class="math inline">\(H_0\)</span>: <span class="math inline">\(y_i = \beta_0 + \epsilon_i\)</span> (i.e.&nbsp;<span class="math inline">\(\beta_1 = \beta_2 = \dots = \beta_p = 0\)</span>)</li>
<li>
<span class="math inline">\(H_A\)</span>: <span class="math inline">\(\beta_k \neq 0\)</span> for at least one value in <span class="math inline">\(k \in \{1, \dots, p\}\)</span>
</li>
</ul>
<p>The null hypothesis essentially states that there is no useful linear relationship between the response and any of the predictors. A small enough p-value suggests strong evidence against the null hypothesis, or in other words the model is better than the most reduced model possible. Useful in multiple linear regression (MLR) where the individual t-tests have suggesting evidence against the null hypothesis that may result in type I errors.</p>
</section><section id="shapiro-wilks-test" class="level2"><h2 class="anchored" data-anchor-id="shapiro-wilks-test">Shapiro-Wilks Test</h2>
<ul>
<li>
<span class="math inline">\(H_0\)</span>: residuals are normal</li>
<li>
<span class="math inline">\(H_a\)</span>: residuals are not normal</li>
</ul>
<p>Used for model diagnostics. With an acceptably low p-value, we would reject the null hypothesis indicating there is enough evidence to suggest the residuals are not normal. A “good” model would have a higher p-value, suggesting normal residuals.</p>
</section><section id="durbin-watson-test" class="level2"><h2 class="anchored" data-anchor-id="durbin-watson-test">Durbin-Watson Test</h2>
<ul>
<li>
<span class="math inline">\(H_0\)</span>: the errors are uncorrelated</li>
<li>
<span class="math inline">\(H_a\)</span>: the errors are correlated (specifically, the residuals exhibit autocorrelation)</li>
</ul>
<p>Used for model diagnostics. With an acceptably low p-value, we would reject the null hypothesis indicating there is enough evidence to suggest the residuals are correlated. A “good” model would have a higher p-value, suggesting uncorrelated residuals.</p>
</section><section id="levenes-test" class="level2"><h2 class="anchored" data-anchor-id="levenes-test">Levenes’ Test</h2>
<ul>
<li>
<span class="math inline">\(H_0\)</span>: the variance among groups/categories is equal</li>
<li>
<span class="math inline">\(H_a\)</span>: the variance among groups/categories is not equal</li>
</ul>
<p>Useful in categorical analysis, and tests for homogeneity of variance.</p>
</section><section id="one-way-anova" class="level2"><h2 class="anchored" data-anchor-id="one-way-anova">One-Way ANOVA</h2>
<ul>
<li>statistic: <span class="math inline">\(F_{stat} = \frac{SSB/SSB_{df}}{SSW/SSW_{df}} = \frac{\frac{SSB}{I-1}}{\frac{SSW}{N-I}}\)</span>
<ul>
<li><span class="math inline">\(SSB_{df} = I - 1\)</span></li>
<li><span class="math inline">\(SSW_{df} = N - I\)</span></li>
<li>
<span class="math inline">\(I\)</span>: number of groups/categories</li>
<li>
<span class="math inline">\(N\)</span>: total number of data points (across all groups/categories; recall that groups can have different number of data points)</li>
</ul>
</li>
<li>
<span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_A = \mu_B = \mu_c = \dots\)</span> for all groups/categories (i.e.&nbsp;the means of each group are the same)</li>
<li>
<span class="math inline">\(H_a\)</span>: at least one of the groups/categories’ means differ from the rest (i.e.&nbsp;at least one pair of means is not equal, or at least one sample mean is not equal to the other)</li>
</ul>
<p>Used for testing for different means between categorical tests. With an acceptably low p-value, we would reject the null hypothesis indicating there is enough evidence to suggest there is at least one differing mean between the categories. We need to test further pairwise sets to determine which is individually different.</p>
</section></section><section id="important-formulas" class="level1"><h1>Important Formulas</h1>
<section id="sse-sum-squared-error-or-rss-residual-sum-of-of-squares" class="level2"><h2 class="anchored" data-anchor-id="sse-sum-squared-error-or-rss-residual-sum-of-of-squares">SSE (Sum Squared Error) or RSS (Residual Sum of of Squares)</h2>
<p><span class="math display">\[SSE = \sum\limits_{i=1}^{n} (y_i - \hat{y_i})^2\]</span></p>
<p><span class="math inline">\(SSE\)</span> is a measure of how much variation is left unexplained by the model, where:</p>
<ul>
<li>
<span class="math inline">\(y_i\)</span>: actual/observed value</li>
<li>
<span class="math inline">\(\hat{y_i}\)</span>: predicted value</li>
</ul></section><section id="sst-sum-of-squares-total-or-tss-total-sum-of-squares" class="level2"><h2 class="anchored" data-anchor-id="sst-sum-of-squares-total-or-tss-total-sum-of-squares">SST (Sum of Squares Total) or TSS (Total Sum of Squares)</h2>
<p><span class="math display">\[SST = \sum\limits_{i=1}^{n} (y_i - \bar{y})^2\]</span></p>
<p><span class="math inline">\(SST\)</span> represents the total amount of variation in observed values (what we would get if we used the mean of the data as our model), where:</p>
<ul>
<li>
<span class="math inline">\(y_i\)</span>: actual/observed value</li>
<li>
<span class="math inline">\(\bar{y_i}\)</span>: mean of the actual/observed values</li>
</ul></section><section id="ssr-sum-of-squared-residuals-or-rss-residual-sum-of-sqaures" class="level2"><h2 class="anchored" data-anchor-id="ssr-sum-of-squared-residuals-or-rss-residual-sum-of-sqaures">SSR (Sum of Squared Residuals) or RSS (Residual Sum of Sqaures)</h2>
<p><span class="math display">\[SSR = \sum\limits_{i=1}^{n} (\hat{y_i} - \bar{y})^2\]</span></p>
<p><span class="math inline">\(SSR\)</span> gives a sense of how much variation in <span class="math inline">\(Y\)</span> is explained by our model.</p>
<ul>
<li>
<span class="math inline">\(\hat{y_i}\)</span>: predicted value</li>
<li>
<span class="math inline">\(\bar{y_i}\)</span>: mean of the actual/observed values</li>
</ul></section><section id="r2" class="level2"><h2 class="anchored" data-anchor-id="r2"><span class="math inline">\(R^2\)</span></h2>
<p><span class="math display">\[R^2 = 1 - \frac{SSE}{SST}\]</span></p>
<p><span class="math inline">\(R^2\)</span> is the proportion of variance that can be explained by the model, and can be used as an indicator of goodness of fit for simple linear regression (SLR) models.</p>
</section><section id="r2_a-adjusted-r2" class="level2"><h2 class="anchored" data-anchor-id="r2_a-adjusted-r2">
<span class="math inline">\(R^2_a\)</span> (Adjusted <span class="math inline">\(R^2\)</span>)</h2>
<p><span class="math display">\[R^2_a = 1 - \frac{SSE/(n-p-1)}{SST/(n-1)}\]</span></p>
<p><span class="math inline">\(R^2_a\)</span> is a better indicator of goodness for multiple linear regression (MLR) models over the normal <span class="math inline">\(R^2\)</span> as it penalizes for having too many features that are not reducing <span class="math inline">\(SSE\)</span>, where:</p>
<ul>
<li>
<span class="math inline">\(n\)</span>: number of observations</li>
<li>
<span class="math inline">\(p\)</span>: number of features</li>
</ul></section><section id="mspe-mean-squared-prediction-error" class="level2"><h2 class="anchored" data-anchor-id="mspe-mean-squared-prediction-error">MSPE (Mean Squared Prediction Error)</h2>
<p><span class="math display">\[MSPE = \frac{1}{n}\sum^n_{i=1} (y_i - \hat{y_i})^2\]</span></p>
<p><span class="math inline">\(MSPE\)</span> quantifies the discrepancy between the predicted values and the observed value, and can help to evalute the performance of a model.</p>
</section><section id="aic-akaike-information-criteria" class="level2"><h2 class="anchored" data-anchor-id="aic-akaike-information-criteria">AIC (Akaike Information Criteria)</h2>
<p><span class="math display">\[AIC = 2(p+1) - 2\log(\frac{SSE}{n})\]</span></p>
<p><span class="math inline">\(AIC\)</span> estimates the relative amount of information that is lost by a given model in effort to minimize the information that’s lost.</p>
</section><section id="bic-bayesian-information-criteria" class="level2"><h2 class="anchored" data-anchor-id="bic-bayesian-information-criteria">BIC (Bayesian Information Criteria)</h2>
<p><span class="math display">\[BIC = (p+1)log(n) - 2logL(\hat{\beta})\]</span></p>
<p><span class="math inline">\(BIC\)</span> is similar estimate to <span class="math inline">\(AIC\)</span> with slightly different parameters, where</p>
<ul>
<li>
<span class="math inline">\(logL(\hat{\beta})\)</span> is the log likelihood function</li>
</ul></section><section id="one-way-anova-equations" class="level2"><h2 class="anchored" data-anchor-id="one-way-anova-equations">One-Way ANOVA Equations</h2>
<section id="sst" class="level3"><h3 class="anchored" data-anchor-id="sst">SST</h3>
<p><span class="math inline">\(SST = \sum\limits_{i=1}^{I} \sum\limits_{j=1}^{n_i} (y_{ij} - \bar{\bar{y}})^2\)</span></p>
<ul>
<li>
<span class="math inline">\(i \in {1, \dots, I}\)</span>: group/category</li>
<li>
<span class="math inline">\(j \in {1, \dots, n_i}\)</span> value within group/category</li>
<li><span class="math inline">\(SST = SSW + SSB\)</span></li>
</ul></section><section id="ssw-within-group-sum-of-squares" class="level3"><h3 class="anchored" data-anchor-id="ssw-within-group-sum-of-squares">SSW (Within-Group Sum of Squares)</h3>
<p><span class="math inline">\(SSW = \sum\limits_{i=1}^{I} \sum\limits_{j=1}^{n_i} (y_{ij} - \bar{y_i})^2\)</span></p>
<p>How much groups are split from their own mean.</p>
</section><section id="ssb-between-group-sum-of-squares" class="level3"><h3 class="anchored" data-anchor-id="ssb-between-group-sum-of-squares">SSB (Between-Group Sum of Squares)</h3>
<p><span class="math inline">\(SSB = \sum\limits_{i=1}^{I} \sum\limits_{j=1}^{n_i} (\bar{y_i} - \bar{\bar{y}})^2\)</span></p>
<p>How much groups are split from the total mean.</p>
</section></section></section><section id="selected-questions" class="level1"><h1>Selected Questions</h1>
<section id="question-1" class="level2"><h2 class="anchored" data-anchor-id="question-1">Question 1</h2>
<p>Explain why, in MLR, conducting multipe t-tests for regression parameters, <span class="math inline">\(\beta_j\)</span>, is problematic and descrbie one solution to this problem.</p>
</section><section id="answer-1" class="level2"><h2 class="anchored" data-anchor-id="answer-1">Answer 1</h2>
<p>Conducting multiple t-tests for regression parameters in MLR is problematic because the more features the more likely you are to commit a Type I error. The probability of committing a single Type I error in a MLR model with just 10 features is about 40%. This is overall problematic because a feature could be shown as being statistically significant to having an effect on the response variable, when it actually isn’t. One solution to this problem is to use a simultaneous test, the F-test.</p>
</section><section id="question-2" class="level2"><h2 class="anchored" data-anchor-id="question-2">Question 2</h2>
<p>Explain (in general) how to compute a percentile bootstrap interval for a proportion.</p>
</section><section id="answer-2" class="level2"><h2 class="anchored" data-anchor-id="answer-2">Answer 2</h2>
<ol type="1">
<li>Resample, with replacement, the original sample many times, having the resample be the same size as the same.</li>
<li>Compute the desired statistic for each resample. In the case it will be a proportion.</li>
<li>Let a be the probability of a type I error (i.e.&nbsp;alpha) such that significance level is (100 - a)%.</li>
</ol>
<p>Then, in the distribution find the corresponding percentiles for [a/2, (100 - a/2)].</p>
<p>That will be your percentile bootstrap interval for a proportion.</p>
</section><section id="question-3" class="level2"><h2 class="anchored" data-anchor-id="question-3">Question 3</h2>
<p>Suppose we want to test the hypothesis that the slope coefficient <span class="math inline">\(\beta_1\)</span> is less than 1 (for a linear regression model). State the appropriate null and alternative hypothesis below</p>
</section><section id="answer-3" class="level2"><h2 class="anchored" data-anchor-id="answer-3">Answer 3</h2>
<ul>
<li>
<span class="math inline">\(H_0\)</span>: <span class="math inline">\(\beta_1 \geq 0\)</span>
</li>
<li>
<span class="math inline">\(H_a\)</span>: <span class="math inline">\(\beta_1 &lt; 0\)</span>
</li>
</ul>
<blockquote class="blockquote">
<p>Here, we see a deviation from past material. The null hypothesis will always contain an equality symbol, however it can be an inequality.</p>
</blockquote>
</section><section id="question-4" class="level2"><h2 class="anchored" data-anchor-id="question-4">Question 4</h2>
<p>Conduct the above hypothesis test.</p>
</section><section id="answer-4" class="level2"><h2 class="anchored" data-anchor-id="answer-4">Answer 4</h2>
<p><span class="math inline">\(t_{stat} = \frac{\hat{B_j} - \beta_j}{SE(\hat{\beta_j})}\)</span></p>
<ul>
<li>calculate test statistic (t-stat)</li>
<li>find rejection region critical value (t-crit)</li>
<li>compare t-stat and t-crit</li>
</ul>
<p>Recall our rejection regions for a given hypothesis test:</p>
<ul>
<li>
<span class="math inline">\(H_a\)</span>: <span class="math inline">\(\theta &gt; \theta_0 \rightarrow test_{stat} \geq rejection_{crit}\)</span>
</li>
<li>
<span class="math inline">\(H_a\)</span>: <span class="math inline">\(\theta &lt; \theta_0 \rightarrow test_{stat} \leq rejection_{crit}\)</span>
</li>
<li>
<span class="math inline">\(H_a\)</span>: <span class="math inline">\(\theta \neq \theta_0 \rightarrow test_{stat} \geq rejection_{crit}\)</span> OR <span class="math inline">\(test_{stat} \leq rejection_{crit}\)</span>
</li>
</ul>
<p>So, in our case, we want to know if <span class="math inline">\(t_{stat} \leq t_{crit}\)</span>. If it is, we have enough evidence to reject the null hypothesis.</p>
</section><section id="question-5" class="level2"><h2 class="anchored" data-anchor-id="question-5">Question 5</h2>
<p>Suppose you have data for the time in second it takes someone to leave their parking spot given the fact that someone is waiting or not.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">not_waiting</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">29.6</span>, <span class="fl">23.5</span>, <span class="fl">31.6</span>, <span class="fl">30</span>, <span class="fl">29.2</span>, <span class="fl">24.4</span>, <span class="fl">34.6</span>, <span class="fl">23</span>, <span class="fl">31.5</span>, <span class="fl">15.3</span>, <span class="fl">32.7</span>, <span class="fl">25.1</span>, <span class="fl">26.8</span>, <span class="fl">27.5</span>, <span class="fl">23.8</span>, <span class="fl">32.2</span>, <span class="fl">34.9</span>, <span class="fl">28.7</span>, <span class="fl">28.4</span>, <span class="fl">26</span><span class="op">)</span></span>
<span></span>
<span><span class="va">waiting</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">35.7</span>, <span class="fl">37.9</span>, <span class="fl">35.2</span>, <span class="fl">22.8</span>, <span class="fl">35.2</span>, <span class="fl">30.2</span>, <span class="fl">23.1</span>, <span class="fl">40.8</span>, <span class="fl">39.7</span>, <span class="fl">32.8</span>, <span class="fl">34</span>, <span class="fl">24.6</span>, <span class="fl">34.3</span>, <span class="fl">20.9</span>, <span class="fl">22.7</span>, <span class="fl">44.5</span>, <span class="fl">31.8</span>, <span class="fl">26.7</span>, <span class="fl">28.4</span>, <span class="fl">38.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>What is the mean time to vacate a parking spot when no one is waiting?</li>
<li>What is the mean time to vacate a parking spot when someone is waiting?</li>
<li>What is the difference in means? (Not Waiting - Waiting)</li>
<li>If we were to run a hypothesis test with randomization, what is the test setup?</li>
<li>Run the test and interpret the result.</li>
</ul></section><section id="answer-5" class="level2"><h2 class="anchored" data-anchor-id="answer-5">Answer 5</h2>
<p><strong>Mean Time to Vacate When Not Waiting</strong></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">not_waiting</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 27.94</code></pre>
</div>
</div>
<p><strong>Mean Time to Vacate When Waiting</strong></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">waiting</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 31.99</code></pre>
</div>
</div>
<p><strong>Difference in Means</strong></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">not_waiting</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">waiting</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] -4.05</code></pre>
</div>
</div>
<p><strong>Hypothesis Test with Randomization</strong></p>
<p>Recall we want to make our null hypothesis the status quo (i.e.&nbsp;we would assume that there is no difference for this case).</p>
<ul>
<li>
<span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_{not waiting} = \mu_{waiting}\)</span>, the difference in mean wait time is 0</li>
<li>
<span class="math inline">\(H_a\)</span>: <span class="math inline">\(\mu_{waiting} &gt; \mu_{not waiting}\)</span>
<ul>
<li><span class="math inline">\(\mu_{waiting} - \mu_{not waiting} &gt; 0\)</span></li>
<li><span class="math inline">\(\mu_{not waiting} - \mu_{waiting} &lt; 0\)</span></li>
</ul>
</li>
</ul>
<p><strong>Perform the Test</strong></p>
<blockquote class="blockquote">
<p>Distribution generated with 40 wait times, distributed into two size 20 groups. The test statistic is marked with a vertical red line.</p>
</blockquote>
<p><img src="images/randomization_example.png" class="img-fluid"></p>
<p>Since there were 1000 differences used to create this histogram, using our standard critical value of <span class="math inline">\(\alpha = 0.05\)</span>, this would put our critical value for the rejection at <span class="math inline">\(50\)</span>. We can approximate that the counts on the histogram are under <span class="math inline">\(25\)</span>, thus giving us <span class="math inline">\(p-value &lt; \frac{25}{1000} = 0.025\)</span>, we can reject the null hypothesis in favor of the alternative hypothesis. There is evidence that the mean wait time when no one is waiting is less than the mean wait time when someone is waiting.</p>
</section><section id="question-6" class="level2"><h2 class="anchored" data-anchor-id="question-6">Question 6</h2>
<p>We found that the OLS estimator for <span class="math inline">\(\beta\)</span> in MLR is given by <span class="math inline">\(\hat{\beta} = (X^TX)^{-1}X^TY\)</span>.</p>
<ul>
<li>What condition must be true about the column of <span class="math inline">\(X\)</span> for the matrix <span class="math inline">\(X^TX\)</span> to be invertible?</li>
<li>How do you diagnose multicollinearity or non-identifiability?</li>
</ul></section><section id="answer-6" class="level2"><h2 class="anchored" data-anchor-id="answer-6">Answer 6</h2>
<p><strong>True Condition</strong></p>
<p>The columns of <span class="math inline">\(X\)</span> must be linearly independent. The inverse does not exist when the columns of <span class="math inline">\(X\)</span> are linearly dependent.</p>
<p><strong>Diagnosing Multicollinearity</strong></p>
<p>We can diagnose multicollinearity or non-identifiability several ways.</p>
<p>Theoretically, if we find linear dependence using linear algebra, then we can notice it that way.</p>
<p>Programmatically, if there is direct linear dependence, then after building a model and preparing a summary, we’ll find NAs within the feature row.</p>
<p>However, true direct linear dependence is VERY rare. Instead, “near” non-identifiability can be recognized (will take more investigation after it is suspected) if there is a “fishy” regression coefficient. For instance, if you know that a coefficient should be positive (good theoretical reasons), but is showing as negative, this could be a sign of multicollinearity.</p>
</section><section id="question-7" class="level2"><h2 class="anchored" data-anchor-id="question-7">Question 7</h2>
<p>Given a one-way ANOVA test, suppose <span class="math inline">\(F_{crit} = 3.006\)</span> with <span class="math inline">\(\alpha = 0.1\)</span>, perform a rejection region test provided we know that <span class="math inline">\(F_{stat} = 6.55 \rightarrow p.value = 0.02\)</span></p>
</section><section id="answer-7" class="level2"><h2 class="anchored" data-anchor-id="answer-7">Answer 7</h2>
<p><span class="math inline">\(0.02 &lt; 0.1\)</span>, thus we reject the null hypothesis.</p>
</section><section id="question-8" class="level2"><h2 class="anchored" data-anchor-id="question-8">Question 8</h2>
<p>Smoothing splines will always go through each data.</p>
</section><section id="answer-8" class="level2"><h2 class="anchored" data-anchor-id="answer-8">Answer 8</h2>
<p>False, going through every data point is an overfit.</p>
</section><section id="question-9" class="level2"><h2 class="anchored" data-anchor-id="question-9">Question 9</h2>
<p>Binomial Regression is a type of nonparametric model.</p>
</section><section id="answer-9" class="level2"><h2 class="anchored" data-anchor-id="answer-9">Answer 9</h2>
<p>False, nonparametric models include kernel regression and GAMs.</p>
</section><section id="question-10" class="level2"><h2 class="anchored" data-anchor-id="question-10">Question 10</h2>
<p><span class="math inline">\(Y = f(x_1, x_2, x_3) = \beta_0 + \beta_1x_1 + e^{x_2} + sin(\pi x_3) + \epsilon\)</span> is an example of an additive model.</p>
</section><section id="answer-10" class="level2"><h2 class="anchored" data-anchor-id="answer-10">Answer 10</h2>
<p>True, however, something like <span class="math inline">\(Y = f(x_1, x_2, x_3) = \beta_0 + \beta_1x_1 + e^{x_2 * x_3} + sin(\pi x_3) + \epsilon\)</span> is not an additive model. The term <span class="math inline">\(e^{x_2 * x_3}\)</span> violates the idea of additivity.</p>
</section><section id="question-11" class="level2"><h2 class="anchored" data-anchor-id="question-11">Question 11</h2>
<p>Suppose we have a Poisson model which explains the number of awards earned by students at a high school in a year based on:</p>
<ul>
<li>math final exam score</li>
<li>type of program they are enrolled in, where the categories are:
<ul>
<li>“Remedial”</li>
<li>“Standard”</li>
<li>“Honors”</li>
</ul>
</li>
</ul>
<p><code>glm(formula = num_awards ~ prog + math, family = "poisson", data = p)</code></p>
<p>Coefficients:</p>
<table class="table">
<thead><tr class="header">
<th></th>
<th>Estimate</th>
<th>Std. Error</th>
<th>z value</th>
<th>P(&gt;</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td>-5.2471</td>
<td>0.6585</td>
<td>-7.97</td>
<td>1.6e-15***</td>
</tr>
<tr class="even">
<td>progStandard</td>
<td>1.0839</td>
<td>0.3583</td>
<td>3.03</td>
<td>0.0025**</td>
</tr>
<tr class="odd">
<td>progHonors</td>
<td>0.3698</td>
<td>0.4411</td>
<td>0.84</td>
<td>0.4018</td>
</tr>
<tr class="even">
<td>math</td>
<td>0.0702</td>
<td>0.0106</td>
<td>6.62</td>
<td>3.6e-11***</td>
</tr>
</tbody>
</table>
<p>What is the expected number of awards for a student who is in the honors program and who’s math final exam is set to the mean of the value of the sample: <span class="math inline">\(math = 53\)</span>. Round to the nearest hundredths place.</p>
</section><section id="answer-11" class="level2"><h2 class="anchored" data-anchor-id="answer-11">Answer 11</h2>
<p><span class="math inline">\(log(\hat{Y}) = \hat{\beta_0} + \hat{\beta_1}x_1 + \hat{\beta_2}x_2 + \hat{\beta_3}x_3\)</span></p>
<p><span class="math inline">\(= -5.2471 + 1.0839 progStandard + 0.3698 progHonors + 0.0702 math\)</span></p>
<p><span class="math inline">\(= -5.2471 + 0.3698 + 0.0702*53\)</span></p>
<p><span class="math inline">\(= -1.1567\)</span></p>
<p><span class="math inline">\(log(\hat{Y}) = -1.1567 \rightarrow \hat{Y} = e^{-1.1567} \approx 0.31\)</span></p>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p><a href="https://clickityklein.github.io/Carl-Klein/">About Carl Klein</a></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>